<head>
  <style>
    body {
      margin: 0;
    }
  </style>

  <!-- <script src="//unpkg.com/force-graph"></script> -->
  <script src="../../dist/force-graph.js"></script>
</head>

<body>
  <div id="graph"></div>

  <script>
    let data = { "nodes": [{ "id": "0:F99B14600AE44D2F12B178E8C6EABD78892AE82C5E45B6898F9DEB7EB203F9C4", "label": "0:F99B14600AE44D2F12B178E8C6EABD78892AE82C5E45B6898F9DEB7EB203F9C4", "group": 1 }, { "id": "0:805D5D624E605BA9FF9FAA45142C2EECBAD9177BE2DFEEB661E19A536F013C09", "label": "0:805D5D624E605BA9FF9FAA45142C2EECBAD9177BE2DFEEB661E19A536F013C09", "group": 1 }, { "id": "0:82A0E277C2322B4B50007301A37DE61D5CE445737750FDE8430A5D776CC968E2", "label": "0:82A0E277C2322B4B50007301A37DE61D5CE445737750FDE8430A5D776CC968E2", "group": 1 }, { "id": "0:C2419D57AE55388C43E100A2D5DA5B05CEBEFAF0968F6306D9826484ECD2E1B9", "label": "0:C2419D57AE55388C43E100A2D5DA5B05CEBEFAF0968F6306D9826484ECD2E1B9", "group": 1 }, { "id": "0:CFE0E2D7715387D6DAF521491CA9ECB641BE91BFBED2EEEF1416FFE6501AB0F8", "label": "0:CFE0E2D7715387D6DAF521491CA9ECB641BE91BFBED2EEEF1416FFE6501AB0F8", "group": 1 }, { "id": "0:E985185FE6A2206CBDFF56C874652965CAB05B38BB7CA0D26F68A30CB07007C3", "label": "0:E985185FE6A2206CBDFF56C874652965CAB05B38BB7CA0D26F68A30CB07007C3", "group": 1 }, { "id": "0:E7736BB031BAF69F1777105B398E23C982544271EA5B6DE8016833EDF9BB0A09", "label": "0:E7736BB031BAF69F1777105B398E23C982544271EA5B6DE8016833EDF9BB0A09", "group": 1 }, { "id": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "label": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "group": 1 }, { "id": "0:7FBB44388D476B065AA9ABECA0910B871835C8593FD1F3CC13587DBAB820ED2E", "label": "0:7FBB44388D476B065AA9ABECA0910B871835C8593FD1F3CC13587DBAB820ED2E", "group": 1 }, { "id": "0:5D6A5BCAF1FBC5CB0596BF70E2D0D19A1403F572A07F44A2B888A516313BF5C1", "label": "0:5D6A5BCAF1FBC5CB0596BF70E2D0D19A1403F572A07F44A2B888A516313BF5C1", "group": 1 }, { "id": "0:21AAE0B3FE4BE9CDFCEAC16D1A76B68BF53216166C5ABEC5ED05F27A6CFF6119", "label": "0:21AAE0B3FE4BE9CDFCEAC16D1A76B68BF53216166C5ABEC5ED05F27A6CFF6119", "group": 1 }, { "id": "0:40E7074B4587AD07FD929AC41FA0B31525CFB375BA724A67C12F07FAB31CFD51", "label": "0:40E7074B4587AD07FD929AC41FA0B31525CFB375BA724A67C12F07FAB31CFD51", "group": 1 }, { "id": "0:738D7A3210E2C1A0A4B05E73E73EBA226E94BD61E88D9737EE4B1392BDA693C9", "label": "0:738D7A3210E2C1A0A4B05E73E73EBA226E94BD61E88D9737EE4B1392BDA693C9", "group": 1 }, { "id": "0:5BA976C3D806064F0C221A1880C9CB7BC5499846581C22BDA1F94DFDF9A4C23B", "label": "0:5BA976C3D806064F0C221A1880C9CB7BC5499846581C22BDA1F94DFDF9A4C23B", "group": 1 }, { "id": "0:4D3D1A7F1B433157508CF03E7E12065F70CF48AF5115E32213494FFB491F92C9", "label": "0:4D3D1A7F1B433157508CF03E7E12065F70CF48AF5115E32213494FFB491F92C9", "group": 1 }, { "id": "0:585566601CE0B49F4D3BECB42B174CD0A335B292ADC720160AB27D63080B80FC", "label": "0:585566601CE0B49F4D3BECB42B174CD0A335B292ADC720160AB27D63080B80FC", "group": 1 }, { "id": "0:2B5C59685E82BDF892229969B396837DB5568CA50F7A3301FBEBD07EAFAF813B", "label": "0:2B5C59685E82BDF892229969B396837DB5568CA50F7A3301FBEBD07EAFAF813B", "group": 1 }, { "id": "0:0889105B5D0C37C450E413BF9FFCBE1337C181FAD1E7BE7E270CA86A0CD38A65", "label": "0:0889105B5D0C37C450E413BF9FFCBE1337C181FAD1E7BE7E270CA86A0CD38A65", "group": 1 }, { "id": "0:3305697C55AB20CBCE0725D39E11CD58ECC88D1B05292B7CE9FADFEC1986A6DC", "label": "0:3305697C55AB20CBCE0725D39E11CD58ECC88D1B05292B7CE9FADFEC1986A6DC", "group": 1 }, { "id": "0:7AAA3F0AE4988AC75F19F2F3FEC496FE8A6EB1CCCC76DE1BE7B79181D50E6039", "label": "0:7AAA3F0AE4988AC75F19F2F3FEC496FE8A6EB1CCCC76DE1BE7B79181D50E6039", "group": 1 }], "links": [{ "source": "0:805D5D624E605BA9FF9FAA45142C2EECBAD9177BE2DFEEB661E19A536F013C09", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 24522 }, { "source": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "target": "0:F99B14600AE44D2F12B178E8C6EABD78892AE82C5E45B6898F9DEB7EB203F9C4", "value": 644596 }, { "source": "0:7FBB44388D476B065AA9ABECA0910B871835C8593FD1F3CC13587DBAB820ED2E", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:5D6A5BCAF1FBC5CB0596BF70E2D0D19A1403F572A07F44A2B888A516313BF5C1", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:E7736BB031BAF69F1777105B398E23C982544271EA5B6DE8016833EDF9BB0A09", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:E985185FE6A2206CBDFF56C874652965CAB05B38BB7CA0D26F68A30CB07007C3", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:21AAE0B3FE4BE9CDFCEAC16D1A76B68BF53216166C5ABEC5ED05F27A6CFF6119", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 25337 }, { "source": "0:C2419D57AE55388C43E100A2D5DA5B05CEBEFAF0968F6306D9826484ECD2E1B9", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 24522 }, { "source": "0:40E7074B4587AD07FD929AC41FA0B31525CFB375BA724A67C12F07FAB31CFD51", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 20425 }, { "source": "0:738D7A3210E2C1A0A4B05E73E73EBA226E94BD61E88D9737EE4B1392BDA693C9", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 25337 }, { "source": "0:5BA976C3D806064F0C221A1880C9CB7BC5499846581C22BDA1F94DFDF9A4C23B", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:82A0E277C2322B4B50007301A37DE61D5CE445737750FDE8430A5D776CC968E2", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 25337 }, { "source": "0:4D3D1A7F1B433157508CF03E7E12065F70CF48AF5115E32213494FFB491F92C9", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 19609 }, { "source": "0:CFE0E2D7715387D6DAF521491CA9ECB641BE91BFBED2EEEF1416FFE6501AB0F8", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 25337 }, { "source": "0:585566601CE0B49F4D3BECB42B174CD0A335B292ADC720160AB27D63080B80FC", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 20425 }, { "source": "0:2B5C59685E82BDF892229969B396837DB5568CA50F7A3301FBEBD07EAFAF813B", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 20425 }, { "source": "0:0889105B5D0C37C450E413BF9FFCBE1337C181FAD1E7BE7E270CA86A0CD38A65", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 25337 }, { "source": "0:3305697C55AB20CBCE0725D39E11CD58ECC88D1B05292B7CE9FADFEC1986A6DC", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 27813 }, { "source": "0:7AAA3F0AE4988AC75F19F2F3FEC496FE8A6EB1CCCC76DE1BE7B79181D50E6039", "target": "0:03EB117DC5AE590AD04AEE55E9D0CC31815B1733DA3FD38F345A8BFFF2F820F9", "value": 20425 }] }
      ;

    let num_out = {};
    let num_in = {};
    for (let node of data["nodes"]) {
      num_out[node.id] = 0;
      num_in[node.id] = 0;
    }

    for (let edge of data["links"]) {
      num_out[edge.source] += 1;
      num_in[edge.target] += 1;
    }
    new Promise((resolve, _) => { resolve(data); }).then(data => {
      const Graph = ForceGraph()
        (document.getElementById('graph'))
        .graphData(data)
        .nodeLabel('id')
        .linkLabel("value")
        .nodeRelSize(3)
        .nodeAutoColorBy('group')
        .linkDirectionalParticles(1)
        .linkWidth(1)
        .linkDirectionalArrowLength(10)
        .nodeColor(node => {
          if (num_out[node.id] == 0) {
            return "#5ce1e6";
          }
          if ((num_out[node.id] == 1) && (num_in[node.id] > 1)) {
            return "yellow";
          }
          return "#d9d9d9";
        })
        // // .linkLineDash("value")
        // // .d3AlphaMin(0)
        .d3AlphaDecay(0.02)
        .d3VelocityDecay(0.8)
        // .zoom(0.2)
        .linkDirectionalArrowRelPos(0.5)
        .linkDirectionalParticleWidth(e => {
          console.log(e);
          return Math.sqrt(e.value) * 0.1 / 2;
        })
        .linkDirectionalParticleSpeed(d => {
          return 0.01;
        });
      // .linkDirectionalParticleSpeed(1);
    });
  </script>
</body>